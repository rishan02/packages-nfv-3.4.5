<!--
 DEVICE
 IF_NAME_IN
 IF_NAME_OUT
 EGRESS_VLANID
 INGRESS_VLANID
-->
<config-template xmlns="http://tail-f.com/ns/config/1.0">
    <devices xmlns="http://tail-f.com/ns/ncs">
        <device tags="merge">
            <name>{$DEVICE}</name>
            <config>
                <interface xmlns="http://tail-f.com/ned/cisco-ios-xr">
                    <Bundle-Ether-subinterface>
                        <Bundle-Ether>
                            <id>{$IF_NAME_IN}.{$EGRESS_VLANID}</id>
                            <rewrite>
                                <ingress>
                                    <tag>
                                        <mode>symmetric</mode>
                                        <pop>1</pop>
                                    </tag>
                                </ingress>
                            </rewrite>
                            <encapsulation>
                                <dot1q>
                                    <vlan-id>{$EGRESS_VLANID}</vlan-id>
                                </dot1q>
                            </encapsulation>
                            <mode>l2transport</mode>
                        </Bundle-Ether>
                        <Bundle-Ether>
                            <id>{$IF_NAME_IN}.{$INGRESS_VLANID}</id>
                            <rewrite>
                                <ingress>
                                    <tag>
                                        <mode>symmetric</mode>
                                        <pop>1</pop>
                                    </tag>
                                </ingress>
                            </rewrite>
                            <encapsulation>
                                <dot1q>
                                    <vlan-id>{$INGRESS_VLANID}</vlan-id>
                                </dot1q>
                            </encapsulation>
                            <mode>l2transport</mode>
                        </Bundle-Ether>
                    </Bundle-Ether-subinterface>
                </interface>
                <interface xmlns="http://tail-f.com/ned/cisco-ios-xr">
                    <Bundle-Ether-subinterface when="{$IS_BUNDLE='true'}">
                        <Bundle-Ether>
                            <id>{$IF_NAME_OUT}.{$EGRESS_VLANID}</id>
                            <rewrite>
                                <ingress>
                                    <tag>
                                        <mode>symmetric</mode>
                                        <pop>1</pop>
                                    </tag>
                                </ingress>
                            </rewrite>
                            <encapsulation>
                                <dot1q>
                                    <vlan-id>{$EGRESS_VLANID}</vlan-id>
                                </dot1q>
                            </encapsulation>
                            <mode>l2transport</mode>
                        </Bundle-Ether>
                        <Bundle-Ether>
                            <id>{$IF_NAME_OUT}.{$INGRESS_VLANID}</id>
                            <rewrite>
                                <ingress>
                                    <tag>
                                        <mode>symmetric</mode>
                                        <pop>1</pop>
                                    </tag>
                                </ingress>
                            </rewrite>
                            <encapsulation>
                                <dot1q>
                                    <vlan-id>{$INGRESS_VLANID}</vlan-id>
                                </dot1q>
                            </encapsulation>
                            <mode>l2transport</mode>
                        </Bundle-Ether>
                    </Bundle-Ether-subinterface>
                <GigabitEthernet when="{$IS_BUNDLE='false'}">
                     <id>{$IF_NAME_OUT}</id>
  				</GigabitEthernet>
                    
                    <GigabitEthernet-subinterface when="{$IS_BUNDLE='false'}">
                     <GigabitEthernet>
                       <id>{$IF_NAME_OUT}.{$EGRESS_VLANID}</id>
                       <rewrite>
                         <ingress>
                           <tag>
                             <pop>1</pop>
                             <mode>symmetric</mode>
                           </tag>
                         </ingress>
                       </rewrite>
                       <encapsulation>
                         <dot1q>
                           <vlan-id>{$IF_NAME_OUT}.{$EGRESS_VLANID}</vlan-id>
                         </dot1q>
                       </encapsulation>                       
                     </GigabitEthernet>
                     <GigabitEthernet>
                       <id>$IF_NAME_OUT}.{$INGRESS_VLANID}</id>
                       <rewrite>
                         <ingress>
                           <tag>
                             <pop>1</pop>
                             <mode>symmetric</mode>
                           </tag>
                         </ingress>
                       </rewrite>
                       <encapsulation>
                         <dot1q>
                           <vlan-id>{$INGRESS_VLANID}</vlan-id>
                         </dot1q>
                       </encapsulation>                      
                     </GigabitEthernet>                    
                   </GigabitEthernet-subinterface>
                   
                </interface>
                <l2vpn xmlns="http://tail-f.com/ned/cisco-ios-xr">
                    <xconnect>
                        <group>
                            <name>XCONNECT_{$EGRESS_VLANID}</name>
                            <p2p>
                                <name>LCONNECT_{$EGRESS_VLANID}</name>
                                <interface>
                                    <name>{$IF_TYPE_OUT}{$IF_NAME_OUT}.{$EGRESS_VLANID}</name>
                                </interface>
                                <interface>
                                    <name>Bundle-Ether{$IF_NAME_IN}.{$EGRESS_VLANID}</name>
                                </interface>
                            </p2p>
                        </group>
                        <group>
                            <name>XCONNECT_{$INGRESS_VLANID}</name>
                            <p2p>
                                <name>LCONNECT_{$INGRESS_VLANID}</name>
                                <interface>
                                    <name>{$IF_TYPE_OUT}{$IF_NAME_OUT}.{$INGRESS_VLANID}</name>
                                </interface>
                                <interface>
                                    <name>Bundle-Ether{$IF_NAME_IN}.{$INGRESS_VLANID}</name>
                                </interface>
                            </p2p>
                        </group>
                    </xconnect>
                </l2vpn>
            </config>
        </device>
    </devices>
</config-template>