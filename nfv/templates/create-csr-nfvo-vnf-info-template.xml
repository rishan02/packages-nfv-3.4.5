<config xmlns="http://tail-f.com/ns/config/1.0">
    <nfvo xmlns="http://tail-f.com/pkg/tailf-etsi-rel2-nfvo">
        <vnf-info>
            <esc xmlns="http://tail-f.com/pkg/tailf-etsi-rel2-nfvo-esc">
                <vnf-deployment>
                    <tenant>{$TENANT}</tenant>
                    <deployment-name>{$DEPNAME}</deployment-name>
                    <esc>{$ESC}</esc>
                    <username>admin</username>
                    <vnf-info>
                        <name>CSR1kv</name>
                        <vnfd>CSR1kv</vnfd>
                        <vnfd-flavor>basic</vnfd-flavor>
                        <instantiation-level>basic</instantiation-level>
                        <vdu>
                            <id>CSR</id>
                            <managed />
                            <image-name>csr</image-name>
                            <flavor-name>csr</flavor-name>
                            <bootup-time>300</bootup-time>
                            <recovery-wait-time>120</recovery-wait-time>
                            <day0>
                                <destination>iosxe_config.txt</destination>
                                <url>file://opt/cisco/esc/images/csr_config.sh</url>
                                <variable>
                                    <name>{$USERNAME}</name>
                                    <value>{$ADMIN_PWD}</value>
                                </variable>
                                <variable>
                                    <name>NICID_0_IP_ADDRESS</name>
                                    <value>{$MGMT_IP}</value>
                                </variable>
                                <variable>
                                    <name>NICID_0_NETMASK</name>
                                    <value>255.255.255.0</value>
                                </variable>
                            </day0>
                            <authgroup>{$AUTH_GROUP}</authgroup>
                             <esc-device-template>
                                 <name>interfaces-ip-address-template</name>
                                <variable>
                                    <name>MGMT_NETWORK_NAME</name>
                                    <value>{$MGMT_NETWORK_NAME}</value>
                                </variable>
                                <variable>
                                    <name>INGRESS_NET</name>
                                    <value>{$INGRESS_NET}</value>
                                </variable>
                                <variable>
                                    <name>EGRESS_NET</name>
                                    <value>{$EGRESS_NET}</value>
                                </variable>
                                <variable>
                                    <name>MGMT_IP</name>
                                    <value>{$MGMT_IP}</value>
                                </variable>
                                <variable>
                                    <name>LAN_IP_ADDRESS</name>
                                    <value>{$LAN_IP_ADDRESS}</value>
                                </variable>
                                <variable>
                                    <name>WAN_IP_ADDRESS</name>
                                    <value>{$WAN_IP_ADDRESS}</value>
                                </variable>
                             </esc-device-template>
                             <esc-device-template when="{$LAN_MAC_ADDRESS!='' and $WAN_MAC_ADDRESS!=''}">
                                 <name>csr-mac-address-template</name>
                                <variable>
                                    <name>INGRESS_NET</name>
                                    <value>{$INGRESS_NET}</value>
                                </variable>
                                <variable>
                                    <name>EGRESS_NET</name>
                                    <value>{$EGRESS_NET}</value>
                                </variable>
                                <variable>
                                    <name>LAN_MAC_ADDRESS</name>
                                    <value>{$LAN_MAC_ADDRESS}</value>
                                </variable>
                                <variable>
                                    <name>WAN_MAC_ADDRESS</name>
                                    <value>{$WAN_MAC_ADDRESS}</value>
                                </variable>
                             </esc-device-template>
                        </vdu>
                        <vnfd-connection-point>
                            <id>mgmt</id>
                            <network-name>{$MGMT_NETWORK_NAME}</network-name>
                        </vnfd-connection-point>
                        <vnfd-connection-point>
                            <id>right</id>
                            <network-name>{$INGRESS_NET}</network-name>
                        </vnfd-connection-point>
                        <vnfd-connection-point>
                            <id>left</id>
                            <network-name>{$EGRESS_NET}</network-name>
                        </vnfd-connection-point>
                    </vnf-info>
                    <additional-network>
                        <network-name>{$INGRESS_NET}</network-name>
                        <subnet>
                            <name>SUBNET-{$INGRESS_VLANID}</name>
                            <network>{$INGRESS_NETWORK}</network>
                        </subnet>
                        <vlan>
                            <physical-network-name>{$VNF_PHYSICAL_NETWORK}</physical-network-name>
                            <id>{$INGRESS_VLANID}</id>
                        </vlan>
                    </additional-network>
                    <additional-network>
                        <network-name>{$EGRESS_NET}</network-name>
                        <subnet>
                            <name>SUBNET-{$EGRESS_VLANID}</name>
                            <network>{$EGRESS_NETWORK}</network>
                        </subnet>
                        <vlan>
                            <physical-network-name>{$VNF_PHYSICAL_NETWORK}</physical-network-name>
                            <id>{$EGRESS_VLANID}</id>
                        </vlan>
                    </additional-network>
                </vnf-deployment>
            </esc>
        </vnf-info>
    </nfvo>
</config>
